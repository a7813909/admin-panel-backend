datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// === ENUMS ===
enum Role {
  USER
  EMPLOYEE
  ADMIN
}

// === –°–£–©–ù–û–°–¢–ò –î–õ–Ø –°–í–Ø–ó–ï–ô ===

// 1. –û–¢–î–ï–õ–´ (Departament)
model Departament {
  id        String   @id @default(uuid())
  name      String   @unique
  employees User[] 
}

// 2. –ó–ê–î–ê–ß–ò (Task) - –î–ª—è –ª–æ–≥–∏–∫–∏ 1–°/–ë–∏—Ç—Ä–∏–∫—Å
model Task {
  id                String    @id @default(uuid())
  title             String    @db.VarChar(255)
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è –∑–∞–¥–∞—á–∏
  
  creatorId         String?   // –†–∞–∑—Ä–µ—à–∞–µ–º NULL –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
  creator           User?     @relation(name: "TaskCreator", fields: [creatorId], references: [id])

  assigneeId        String?   // –ü–µ—Ä–µ–Ω–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —é–∑–µ—Ä–∞
  assignee          User?     @relation(name: "TaskAssignee", fields: [assigneeId], references: [id])
  
  updatedAt         DateTime  @updatedAt
  createdAt         DateTime  @default(now())
}


// === –û–°–ù–û–í–ù–ê–Ø –°–£–©–ù–û–°–¢–¨ ===
model User {
  id                String       @id @default(uuid())
  email             String       @unique
  password          String      
  name              String?      // –°–¥–µ–ª–∞–µ–º name –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–º
  
  // üéØ –†–æ–ª–∏ –∏ –û—Ç–¥–µ–ª—ã
  role              Role         @default(USER) 
  departamentId     String
  departament       Departament? @relation(fields: [departamentId], references: [id])
  
  // üéØ –°–≤—è–∑–∏ —Å –∑–∞–¥–∞—á–∞–º–∏
  tasks_created     Task[]       @relation(name: "TaskCreator")
  tasks_assigned    Task[]       @relation(name: "TaskAssignee")
  
  createdAt         DateTime     @default(now())
  updatedAt         DateTime     @updatedAt
}
